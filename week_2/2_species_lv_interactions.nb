(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26392,        737]
NotebookOptionsPosition[     25694,        716]
NotebookOutlinePosition[     26083,        732]
CellTagsIndexPosition[     26040,        729]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"Clear", " ", "all", " ", "variables"}], "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parameters", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DN1", "->", "0.5"}], ",", 
      RowBox[{"DN2", "->", "0.7"}], ",", 
      RowBox[{"DR1", "->", "2.2"}], ",", 
      RowBox[{"DR2", "->", "2"}], ",", 
      RowBox[{"K", "->", "1"}], ",", 
      RowBox[{"m1", "->", "0.12"}], ",", 
      RowBox[{"m2", "->", "0.1"}], ",", 
      RowBox[{"L", "->", "30"}], ",", 
      RowBox[{"N10", "->", "1"}], ",", 
      RowBox[{"N20", "->", "1"}], ",", 
      RowBox[{"TOTALTIME", "->", "100"}], ",", 
      RowBox[{"n", "->", "2"}], ",", 
      RowBox[{"Y1", "->", "2"}], ",", 
      RowBox[{"Y2", "->", "1"}], ",", 
      RowBox[{"phiw", "->", "0.1"}]}], "}"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"Added", " ", "phi_w"}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Manually", " ", "specify", " ", "the", " ", "k", " ", "and", " ", "alpha",
     " ", "matrix"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kMatrix", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
     "               ", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaMatrix", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0.6"}], "}"}], ",", "\[IndentingNewLine]", 
      "\t\t      ", 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "g", " ", "and", " ", "f", " ", "functions", " ", "for", 
    " ", "each", " ", "species", " ", "i", " ", "and", " ", "resource", " ", 
    "j"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"i_", ",", "j_", ",", "R_", ",", "Y_"}], "]"}], ":=", 
   RowBox[{"Y", " ", 
    RowBox[{"kMatrix", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "R"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"i_", ",", "j_", ",", "N_", ",", "R_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"kMatrix", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "N", " ", "R"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "the", " ", "initial", " ", "conditions", " ", "with", " ", 
    "C1", " ", "and", " ", "C2"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"R1Init", "[", 
    RowBox[{"x_", ",", "C1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"C1", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"x", "/", "L"}]}], ")"}], "^", "n"}]}], "/.", " ", 
    "parameters"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R2Init", "[", 
     RowBox[{"x_", ",", "C2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"C2", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"x", "/", "L"}]}], ")"}], "^", "n"}]}], "/.", " ", 
     "parameters"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Take", " ", "the", " ", "derivatives", " ", "at", " ", "x"}], 
    "=", 
    RowBox[{
     RowBox[{"0", " ", "and", " ", "x"}], "=", "L"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dR1Init0", "[", "C1_", "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"R1Init", "[", 
       RowBox[{"x", ",", "C1"}], "]"}], ",", "x"}], "]"}], "/.", " ", 
    RowBox[{"x", "->", "0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dR2Init0", "[", "C2_", "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"R2Init", "[", 
       RowBox[{"x", ",", "C2"}], "]"}], ",", "x"}], "]"}], "/.", " ", 
    RowBox[{"x", "->", "0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dR1InitL", "[", "C1_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"R1Init", "[", 
        RowBox[{"x", ",", "C1"}], "]"}], ",", "x"}], "]"}], "/.", " ", 
     RowBox[{"x", "->", "L"}]}], "/.", " ", "parameters"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dR2InitL", "[", "C2_", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"R2Init", "[", 
         RowBox[{"x", ",", "C2"}], "]"}], ",", "x"}], "]"}], "/.", " ", 
      RowBox[{"x", "->", "L"}]}], "/.", " ", "parameters"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Solve", " ", "for", " ", "C1", " ", "and", " ", "C2", " ", "self"}], "-",
     "consistently"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"dR1Init0", "[", "C1", "]"}], "==", 
     RowBox[{"K", "-", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "1", ",", "N10", ",", 
        RowBox[{"R1Init", "[", 
         RowBox[{"0", ",", "C1"}], "]"}]}], "]"}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "1", ",", "N20", ",", 
        RowBox[{"R1Init", "[", 
         RowBox[{"0", ",", "C1"}], "]"}]}], "]"}]}]}], "/.", " ", 
    "parameters"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eq2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"dR2Init0", "[", "C2", "]"}], "==", 
     RowBox[{"K", "-", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "2", ",", "N10", ",", 
        RowBox[{"R2Init", "[", 
         RowBox[{"0", ",", "C2"}], "]"}]}], "]"}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "2", ",", "N20", ",", 
        RowBox[{"R2Init", "[", 
         RowBox[{"0", ",", "C2"}], "]"}]}], "]"}]}]}], "/.", " ", 
    "parameters"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eq3", "=", 
   RowBox[{
    RowBox[{"dR1InitL", "[", "C1", "]"}], "==", "0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eq4", "=", 
    RowBox[{
     RowBox[{"dR2InitL", "[", "C2", "]"}], "==", "0"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq1", ",", "eq2", ",", "eq3", ",", "eq4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"C1", ",", "C2"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"C1", "=", 
   RowBox[{"C1", "/.", " ", 
    RowBox[{"First", "[", "sol", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"C2", "=", 
    RowBox[{"C2", "/.", " ", 
     RowBox[{"First", "[", "sol", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "the", " ", "PDE", " ", "system", " ", "with", " ", "new", 
    " ", "terms"}], "*)"}], 
  RowBox[{
   RowBox[{"PDEs", "=", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"N1", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "==", 
        RowBox[{
         RowBox[{"DN1", " ", 
          RowBox[{"Laplacian", "[", 
           RowBox[{
            RowBox[{"N1", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"N1", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "phiw"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"R1", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], ",", "Y1"}], "]"}], "+", 
              RowBox[{"g", "[", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"R2", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], ",", "Y2"}], "]"}], "-", 
              "m1"}], ")"}]}], ")"}]}], "+", 
         RowBox[{"phiw", " ", 
          RowBox[{"N1", "[", 
           RowBox[{"t", ",", "x"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"alphaMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
            RowBox[{"N2", "[", 
             RowBox[{"t", ",", "x"}], "]"}]}], ")"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"N2", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "==", 
        RowBox[{
         RowBox[{"DN2", " ", 
          RowBox[{"Laplacian", "[", 
           RowBox[{
            RowBox[{"N2", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"N2", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "phiw"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"2", ",", "1", ",", 
                RowBox[{"R1", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], ",", "Y1"}], "]"}], "+", 
              RowBox[{"g", "[", 
               RowBox[{"2", ",", "2", ",", 
                RowBox[{"R2", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], ",", "Y2"}], "]"}], "-", 
              "m2"}], ")"}]}], ")"}]}], "+", 
         RowBox[{"phiw", " ", 
          RowBox[{"N2", "[", 
           RowBox[{"t", ",", "x"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"alphaMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", 
            RowBox[{"N1", "[", 
             RowBox[{"t", ",", "x"}], "]"}]}], ")"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "==", 
        RowBox[{
         RowBox[{"DR1", " ", 
          RowBox[{"Laplacian", "[", 
           RowBox[{
            RowBox[{"R1", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", "x", "}"}]}], "]"}]}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "1", ",", 
           RowBox[{"N1", "[", 
            RowBox[{"t", ",", "x"}], "]"}], ",", 
           RowBox[{"R1", "[", 
            RowBox[{"t", ",", "x"}], "]"}]}], "]"}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "1", ",", 
           RowBox[{"N2", "[", 
            RowBox[{"t", ",", "x"}], "]"}], ",", 
           RowBox[{"R1", "[", 
            RowBox[{"t", ",", "x"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "==", 
        RowBox[{
         RowBox[{"DR2", " ", 
          RowBox[{"Laplacian", "[", 
           RowBox[{
            RowBox[{"R2", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", "x", "}"}]}], "]"}]}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "2", ",", 
           RowBox[{"N1", "[", 
            RowBox[{"t", ",", "x"}], "]"}], ",", 
           RowBox[{"R2", "[", 
            RowBox[{"t", ",", "x"}], "]"}]}], "]"}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "2", ",", 
           RowBox[{"N2", "[", 
            RowBox[{"t", ",", "x"}], "]"}], ",", 
           RowBox[{"R2", "[", 
            RowBox[{"t", ",", "x"}], "]"}]}], "]"}]}]}]}], "}"}], "/.", " ", 
     "parameters"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Modified", " ", "Neumann", " ", "boundary", " ", "conditions"}], 
   "*)"}], 
  RowBox[{
   RowBox[{"bc", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", "N1", "]"}], "[", 
         RowBox[{"t", ",", "0"}], "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", "N1", "]"}], "[", 
         RowBox[{"t", ",", "L"}], "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", "N2", "]"}], "[", 
         RowBox[{"t", ",", "0"}], "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", "N2", "]"}], "[", 
         RowBox[{"t", ",", "L"}], "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", "R1", "]"}], "[", 
         RowBox[{"t", ",", "0"}], "]"}], "==", 
        RowBox[{"K", "-", 
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "1", ",", 
           RowBox[{"N1", "[", 
            RowBox[{"t", ",", "0"}], "]"}], ",", 
           RowBox[{"R1", "[", 
            RowBox[{"t", ",", "0"}], "]"}]}], "]"}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "1", ",", 
           RowBox[{"N2", "[", 
            RowBox[{"t", ",", "0"}], "]"}], ",", 
           RowBox[{"R1", "[", 
            RowBox[{"t", ",", "0"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", "R1", "]"}], "[", 
         RowBox[{"t", ",", "L"}], "]"}], "==", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"f", "[", 
           RowBox[{"1", ",", "1", ",", 
            RowBox[{"N1", "[", 
             RowBox[{"t", ",", "L"}], "]"}], ",", 
            RowBox[{"R1", "[", 
             RowBox[{"t", ",", "L"}], "]"}]}], "]"}]}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "1", ",", 
           RowBox[{"N2", "[", 
            RowBox[{"t", ",", "L"}], "]"}], ",", 
           RowBox[{"R1", "[", 
            RowBox[{"t", ",", "L"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", "R2", "]"}], "[", 
         RowBox[{"t", ",", "0"}], "]"}], "==", 
        RowBox[{"K", "-", 
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "2", ",", 
           RowBox[{"N1", "[", 
            RowBox[{"t", ",", "0"}], "]"}], ",", 
           RowBox[{"R2", "[", 
            RowBox[{"t", ",", "0"}], "]"}]}], "]"}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "2", ",", 
           RowBox[{"N2", "[", 
            RowBox[{"t", ",", "0"}], "]"}], ",", 
           RowBox[{"R2", "[", 
            RowBox[{"t", ",", "0"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", "R2", "]"}], "[", 
         RowBox[{"t", ",", "L"}], "]"}], "==", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"f", "[", 
           RowBox[{"1", ",", "2", ",", 
            RowBox[{"N1", "[", 
             RowBox[{"t", ",", "L"}], "]"}], ",", 
            RowBox[{"R2", "[", 
             RowBox[{"t", ",", "L"}], "]"}]}], "]"}]}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "2", ",", 
           RowBox[{"N2", "[", 
            RowBox[{"t", ",", "L"}], "]"}], ",", 
           RowBox[{"R2", "[", 
            RowBox[{"t", ",", "L"}], "]"}]}], "]"}]}]}]}], "}"}], "/.", " ", 
     "parameters"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Initial", " ", "conditions", " ", "with", " ", "solved", " ", "C1", " ", 
    "and", " ", "C2"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ic", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"N1", "[", 
         RowBox[{"0", ",", "x"}], "]"}], "==", "N10"}], "/.", " ", 
       "parameters"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"N2", "[", 
         RowBox[{"0", ",", "x"}], "]"}], "==", "N20"}], "/.", " ", 
       "parameters"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"R1", "[", 
         RowBox[{"0", ",", "x"}], "]"}], "==", 
        RowBox[{"C1", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"x", "/", "L"}]}], ")"}], "^", "n"}]}]}], "/.", " ", 
       "parameters"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"R2", "[", 
         RowBox[{"0", ",", "x"}], "]"}], "==", 
        RowBox[{"C2", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"x", "/", "L"}]}], ")"}], "^", "n"}]}]}], "/.", " ", 
       "parameters"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Solve", " ", "the", " ", "PDE", " ", "system", " ", "numerically"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"solution", "=", 
    RowBox[{"NDSolve", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"PDEs", ",", "bc", ",", "ic"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"N1", ",", "N2", ",", "R1", ",", "R2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", 
        RowBox[{"TOTALTIME", "/.", " ", "parameters"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"L", "/.", " ", "parameters"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Plot", " ", "the", " ", "results"}], "*)"}], 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"N1", "[", 
              RowBox[{"t", ",", "x"}], "]"}], ",", 
             RowBox[{"N2", "[", 
              RowBox[{"t", ",", "x"}], "]"}]}], "}"}], "/.", " ", 
           RowBox[{"First", "[", "solution", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"L", "/.", " ", "parameters"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "->", "Full"}], ",", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<N1(t, x)\>\"", ",", "\"\<N2(t, x)\>\""}], "}"}]}], 
         ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Abundance\>\"", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Position x\>\"", ",", "\"\<Species Abundances\>\""}], 
             "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"R1", "[", 
              RowBox[{"t", ",", "x"}], "]"}], ",", 
             RowBox[{"R2", "[", 
              RowBox[{"t", ",", "x"}], "]"}]}], "}"}], "/.", " ", 
           RowBox[{"First", "[", "solution", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"L", "/.", " ", "parameters"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "->", "Full"}], ",", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<R1(t, x)\>\"", ",", "\"\<R2(t, x)\>\""}], "}"}]}], 
         ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Concentration\>\"", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Position x\>\"", ",", "\"\<Resource Concentrations\>\""}], 
             "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], "}"}], "]"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", 
      RowBox[{"TOTALTIME", "/.", " ", "parameters"}]}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.906464513016409*^9, 3.906464513018725*^9}, 
   3.906464648608123*^9, 3.9064646814159727`*^9, {3.906510110012967*^9, 
   3.906510125188425*^9}, {3.906510202055028*^9, 3.906510202326399*^9}, {
   3.906510621899329*^9, 3.906510680589795*^9}, {3.906510718847928*^9, 
   3.906510723550703*^9}, {3.906510830288762*^9, 3.906511029305978*^9}, {
   3.906511251973297*^9, 3.90651139268244*^9}, {3.906511464221891*^9, 
   3.906511517244567*^9}, 3.906799718843841*^9, {3.9067998748466673`*^9, 
   3.906799875500448*^9}, {3.9068010445327*^9, 3.906801044577508*^9}, {
   3.9068938727169333`*^9, 3.9068938849768257`*^9}, {3.906893920324294*^9, 
   3.906893970201429*^9}, {3.906894118654872*^9, 3.906894134398539*^9}, {
   3.9068941819476433`*^9, 3.90689421464148*^9}, {3.906894415998156*^9, 
   3.9068944202589293`*^9}, {3.906894517380459*^9, 3.906894621834341*^9}, {
   3.907041011495685*^9, 3.907041042776373*^9}, {3.907041101530789*^9, 
   3.907041129375647*^9}, {3.907043333737668*^9, 3.907043425822508*^9}, {
   3.907043495611681*^9, 3.907043624146735*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"bc63137d-f8e6-4ce2-ace3-95bbdd4d0715"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 100., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 100}}, Typeset`size$$ = {
    443.19999999999993`, {247.78749999999997`, 253.41249999999997`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Column[{
         Plot[
          Evaluate[
           ReplaceAll[{
             $CellContext`N1[$CellContext`t$$, $CellContext`x], 
             $CellContext`N2[$CellContext`t$$, $CellContext`x]}, 
            First[$CellContext`solution]]], {$CellContext`x, 0, 
           ReplaceAll[$CellContext`L, $CellContext`parameters]}, PlotRange -> 
          Full, PlotLegends -> {"N1(t, x)", "N2(t, x)"}, Frame -> True, 
          FrameLabel -> {{"Abundance", None}, {
            "Position x", "Species Abundances"}}, ImageSize -> Medium], 
         Plot[
          Evaluate[
           ReplaceAll[{
             $CellContext`R1[$CellContext`t$$, $CellContext`x], 
             $CellContext`R2[$CellContext`t$$, $CellContext`x]}, 
            First[$CellContext`solution]]], {$CellContext`x, 0, 
           ReplaceAll[$CellContext`L, $CellContext`parameters]}, PlotRange -> 
          Full, PlotLegends -> {"R1(t, x)", "R2(t, x)"}, Frame -> True, 
          FrameLabel -> {{"Concentration", None}, {
            "Position x", "Resource Concentrations"}}, ImageSize -> Medium]}],
       "Specifications" :> {{$CellContext`t$$, 0, 100}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{490., {292.6875, 298.3125}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.906893950572405*^9, 3.906893970558557*^9}, {
  3.906894190847575*^9, 3.906894215408968*^9}, {3.906894613834754*^9, 
  3.906894622249773*^9}, {3.907041013210647*^9, 3.907041022934517*^9}, {
  3.907041102718562*^9, 3.907041129752734*^9}, {3.9070435268109827`*^9, 
  3.907043624527483*^9}},
 CellLabel->
  "Out[402]=",ExpressionUUID->"7c4f36e4-d73d-4e92-b364-422f62c3d775"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "Y"}]], "Input",
 CellChangeTimes->{{3.9068942051370077`*^9, 3.906894205384634*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"428bb7a3-04a6-4700-bd1c-799222fb14c0"],

Cell[BoxData["Y"], "Output",
 CellChangeTimes->{3.906894205715179*^9},
 CellLabel->
  "Out[173]=",ExpressionUUID->"5ead6253-f5a0-4727-aaca-27523b8618db"]
}, Open  ]]
},
WindowSize->{1440, 762},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Linux x86 (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"086f3e6d-3e31-43d4-b22c-36af7daeaad9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 21759, 617, 1226, "Input",ExpressionUUID->"bc63137d-f8e6-4ce2-ace3-95bbdd4d0715"],
Cell[22342, 641, 2930, 58, 610, "Output",ExpressionUUID->"7c4f36e4-d73d-4e92-b364-422f62c3d775"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25309, 704, 213, 4, 50, "Input",ExpressionUUID->"428bb7a3-04a6-4700-bd1c-799222fb14c0"],
Cell[25525, 710, 153, 3, 33, "Output",ExpressionUUID->"5ead6253-f5a0-4727-aaca-27523b8618db"]
}, Open  ]]
}
]
*)

